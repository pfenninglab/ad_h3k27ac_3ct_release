conda activate ldsc


for i in {1..22}
do
    # annot for cell type peaks

    python /ldsc/make_annot.py --bed-file /peaks/cell_type_peaks_hpc_dlpfc_reproducible/dlpfc_hpc_combined_controls_Microglia/peak/macs2/overlap/optimal_set/dlpfc_hpc_combined_controls_Microglia_ppr.naive_overlap.filt.narrowPeak.gz --bimfile /resources/1000G_EUR_Phase3_plink/1000G.EUR.QC.${i}.bim --annot-file /ldsc_analysis/controls_Microglia.${i}.annot
    python /ldsc/make_annot.py --bed-file /peaks/cell_type_peaks_hpc_dlpfc_reproducible/dlpfc_hpc_combined_controls_Neuron/peak/macs2/overlap/optimal_set/dlpfc_hpc_combined_controls_Neuron_ppr.naive_overlap.filt.narrowPeak.gz --bimfile /resources/1000G_EUR_Phase3_plink/1000G.EUR.QC.${i}.bim --annot-file /ldsc_analysis/controls_Neuron.${i}.annot
    python /ldsc/make_annot.py --bed-file /peaks/cell_type_peaks_hpc_dlpfc_reproducible/dlpfc_hpc_combined_controls_Glia/peak/macs2/overlap/optimal_set/dlpfc_hpc_combined_controls_Glia_ppr.naive_overlap.filt.narrowPeak.gz --bimfile /resources/1000G_EUR_Phase3_plink/1000G.EUR.QC.${i}.bim --annot-file /ldsc_analysis/controls_Glia.${i}.annot
    
    python /ldsc/ldsc.py --l2 --bfile /resources/1000G_EUR_Phase3_plink/1000G.EUR.QC.${i} --ld-wind-cm 1 --annot /ldsc_analysis/controls_Microglia.${i}.annot --thin-annot --out /ldsc_analysis/controls_Microglia.${i} --print-snps /resources/hapmap3_snps/hm.${i}.snp
    python /ldsc/ldsc.py --l2 --bfile /resources/1000G_EUR_Phase3_plink/1000G.EUR.QC.${i} --ld-wind-cm 1 --annot /ldsc_analysis/controls_Neuron.${i}.annot --thin-annot --out /ldsc_analysis/controls_Neuron.${i} --print-snps /resources/hapmap3_snps/hm.${i}.snp
    python /ldsc/ldsc.py --l2 --bfile /resources/1000G_EUR_Phase3_plink/1000G.EUR.QC.${i} --ld-wind-cm 1 --annot /ldsc_analysis/controls_Glia.${i}.annot --thin-annot --out /ldsc_analysis/controls_Glia.${i} --print-snps /resources/hapmap3_snps/hm.${i}.snp

    
    # annot for background peaks
    python /ldsc/make_annot.py --bed-file dlpfc_hpc_combined_controls_cell_type_reproducible.bed --bimfile /resources/1000G_EUR_Phase3_plink/1000G.EUR.QC.${i}.bim --annot-file /ldsc_analysis/dlpfc_hpc_combined_controls_cell_type_set.${i}.annot
    python /ldsc/ldsc.py --l2 --bfile /resources/1000G_EUR_Phase3_plink/1000G.EUR.QC.${i} --ld-wind-cm 1 --annot /ldsc_analysis/dlpfc_hpc_combined_controls_cell_type_set.${i}.annot --thin-annot --out /ldsc_analysis/dlpfc_hpc_combined_controls_cell_type_set.${i} --print-snps /resources/hapmap3_snps/hm.${i}.snp
    
done


python /ldsc/ldsc.py --h2-cts /resources/Jansen_GWAS.sumstats.gz --ref-ld-chr /resources/1000G_EUR_Phase3_baseline/baseline. --out jansen_enrichments_reproducible --ref-ld-chr-cts ldsc_cell_type_reproducible_enrichment.ldcts --w-ld-chr /resources/weights_hm3_no_hla/weights.
python /ldsc/ldsc.py --h2-cts /resources/Kunkle_GWAS.sumstats.gz --ref-ld-chr /resources/1000G_EUR_Phase3_baseline/baseline. --out kunkle_enrichments_reproducible --ref-ld-chr-cts ldsc_cell_type_reproducible_enrichment.ldcts --w-ld-chr /resources/weights_hm3_no_hla/weights.

python ldsc.py --h2 /resources/Jansen_GWAS.sumstats.gz --ref-ld-chr /ldsc_analysis/controls_Neuron.,/ldsc_analysis/controls_Microglia.,/ldsc_analysis/controls_Glia.,/ldsc_analysis/dlpfc_hpc_combined_controls_cell_type_set.,/resources/baselineLD_v2.2_bedfiles/CTCF_Hoffman.extend.500.,/resources/baselineLD_v2.2_bedfiles/Conserved_LindbladToh.,/resources/baselineLD_v2.2_bedfiles/Coding_UCSC.,/resources/baselineLD_v2.2_bedfiles/Conserved_LindbladToh.extend.500.,/resources/baselineLD_v2.2_bedfiles/CTCF_Hoffman.,/resources/baselineLD_v2.2_bedfiles/DGF_ENCODE.,/resources/baselineLD_v2.2_bedfiles/DHS_Trynka.,/resources/baselineLD_v2.2_bedfiles/DGF_ENCODE.extend.500.,/resources/baselineLD_v2.2_bedfiles/Enhancer_Hoffman.extend.500.,/resources/baselineLD_v2.2_bedfiles/Enhancer_Hoffman.,/resources/baselineLD_v2.2_bedfiles/DHS_peaks_Trynka.,/resources/baselineLD_v2.2_bedfiles/Enhancer_Andersson.,/resources/baselineLD_v2.2_bedfiles/Enhancer_Andersson.extend.500.,/resources/baselineLD_v2.2_bedfiles/DHS_Trynka.extend.500.,/resources/baselineLD_v2.2_bedfiles/H3K27ac_Hnisz.extend.500.,/resources/baselineLD_v2.2_bedfiles/H3K27ac_PGC2.extend.500.,/resources/baselineLD_v2.2_bedfiles/H3K27ac_Hnisz.,/resources/baselineLD_v2.2_bedfiles/H3K27ac_PGC2.,/resources/baselineLD_v2.2_bedfiles/FetalDHS_Trynka.extend.500.,/resources/baselineLD_v2.2_bedfiles/FetalDHS_Trynka.,/resources/baselineLD_v2.2_bedfiles/H3K4me1_peaks_Trynka.,/resources/baselineLD_v2.2_bedfiles/H3K4me1_Trynka.extend.500.,/resources/baselineLD_v2.2_bedfiles/H3K4me3_peaks_Trynka.,/resources/baselineLD_v2.2_bedfiles/H3K9ac_Trynka.,/resources/baselineLD_v2.2_bedfiles/H3K4me1_Trynka.,/resources/baselineLD_v2.2_bedfiles/H3K9ac_peaks_Trynka.,/resources/baselineLD_v2.2_bedfiles/H3K9ac_Trynka.extend.500.,/resources/baselineLD_v2.2_bedfiles/H3K4me3_Trynka.,/resources/baselineLD_v2.2_bedfiles/Promoter_UCSC.extend.500.,/resources/baselineLD_v2.2_bedfiles/H3K4me3_Trynka.extend.500.,/resources/baselineLD_v2.2_bedfiles/PromoterFlanking_Hoffman.extend.500.,/resources/baselineLD_v2.2_bedfiles/Promoter_UCSC.,/resources/baselineLD_v2.2_bedfiles/PromoterFlanking_Hoffman.,/resources/baselineLD_v2.2_bedfiles/SuperEnhancer_Hnisz.extend.500.,/resources/baselineLD_v2.2_bedfiles/Intron_UCSC.extend.500.,/resources/baselineLD_v2.2_bedfiles/SuperEnhancer_Hnisz.,/resources/baselineLD_v2.2_bedfiles/Intron_UCSC.,/resources/baselineLD_v2.2_bedfiles/Repressed_Hoffman.extend.500.,/resources/baselineLD_v2.2_bedfiles/Repressed_Hoffman.,/resources/baselineLD_v2.2_bedfiles/Transcribed_Hoffman.,/resources/baselineLD_v2.2_bedfiles/TFBS_ENCODE.extend.500.,/resources/baselineLD_v2.2_bedfiles/TFBS_ENCODE.,/resources/baselineLD_v2.2_bedfiles/UTR_5_UCSC.extend.500.,/resources/baselineLD_v2.2_bedfiles/UTR_5_UCSC.,/resources/baselineLD_v2.2_bedfiles/WeakEnhancer_Hoffman.,/resources/baselineLD_v2.2_bedfiles/UTR_3_UCSC.extend.500.,/resources/baselineLD_v2.2_bedfiles/UTR_3_UCSC.,/resources/baselineLD_v2.2_bedfiles/TSS_Hoffman.extend.500.,/resources/baselineLD_v2.2_bedfiles/TSS_Hoffman.,/resources/baselineLD_v2.2_bedfiles/Transcribed_Hoffman.extend.500.,/resources/baselineLD_v2.2_bedfiles/WeakEnhancer_Hoffman.extend.500.,/resources/baselineLD_v2.2_bedfiles/Conserved_Vertebrate_phastCons46way.extend.500.,/resources/baselineLD_v2.2_bedfiles/Conserved_Mammal_phastCons46way.extend.500.,/resources/baselineLD_v2.2_bedfiles/Conserved_Primate_phastCons46way.extend.500.,/resources/baselineLD_v2.2_bedfiles/Conserved_Mammal_phastCons46way.,/resources/baselineLD_v2.2_bedfiles/Conserved_Primate_phastCons46way.,/resources/baselineLD_v2.2_bedfiles/Conserved_Vertebrate_phastCons46way.,/resources/baselineLD_v2.2_bedfiles/BivFlnk.extend.500.,/resources/baselineLD_v2.2_bedfiles/BivFlnk.,/resources/baselineLD_v2.2_bedfiles/Vahedi_Tcell_TE.,/resources/baselineLD_v2.2_bedfiles/Vahedi_Tcell_TE_500bp.,/resources/baselineLD_v2.2_bedfiles/Vahedi_Tcell_SE.,/resources/baselineLD_v2.2_bedfiles/Vahedi_Tcell_SE_500bp.,/resources/baselineLD_v2.2_bedfiles/ASMC.,/resources/baselineLD_v2.2_bedfiles/Human_Promoter_Villar_ExAC.,/resources/baselineLD_v2.2_bedfiles/Human_Enhancer_Villar.,/resources/baselineLD_v2.2_bedfiles/Human_Promoter_Villar.,/resources/baselineLD_v2.2_bedfiles/Ancient_Sequence_Age_Human_Promoter.,/resources/baselineLD_v2.2_bedfiles/Ancient_Sequence_Age_Human_Enhancer.,/resources/baselineLD_v2.2_bedfiles/Human_Promoter_Villar.extend.500.,/resources/baselineLD_v2.2_bedfiles/Human_Promoter_Villar_ExAC.extend.500.,/resources/baselineLD_v2.2_bedfiles/Human_Enhancer_Villar.extend.500.,/resources/baselineLD_v2.2_bedfiles/Ancient_Sequence_Age_Human_Promoter.extend.500.,/resources/baselineLD_v2.2_bedfiles/Ancient_Sequence_Age_Human_Enhancer.extend.500.,/resources/baselineLD_v2.2_bedfiles/Human_Enhancer_Villar_Species_Enhancer_Count.,/resources/baselineLD_v2.2_bedfiles/Backgrd_Selection_Stat.,/resources/baselineLD_v2.2_bedfiles/GTEx_FE_META_TISSUE_GE_MaxCPP.,/resources/baselineLD_v2.2_bedfiles/BLUEPRINT_FE_META_TISSUE_H3K4me1_MaxCPP.,/resources/baselineLD_v2.2_bedfiles/BLUEPRINT_FE_META_TISSUE_H3K27ac_MaxCPP.,/resources/baselineLD_v2.2_bedfiles/BLUEPRINT_FE_META_TISSUE_DNAMETH_MaxCPP.,/resources/baselineLD_v2.2_bedfiles/alleleage.,/resources/baselineLD_v2.2_bedfiles/Coding_UCSC.extend.500. --out kunkle_enrichments_reproducible.heritability --thin-annot  --frqfile-chr /resources/1000G_Phase3_frq/1000G.EUR.QC. --w-ld-chr /resources/weights_hm3_no_hla/weights. --print-coefficients
python ldsc.py --h2 /resources/Kunkle_GWAS.sumstats.gz --ref-ld-chr /ldsc_analysis/controls_Neuron.,/ldsc_analysis/controls_Microglia.,/ldsc_analysis/controls_Glia.,/ldsc_analysis/dlpfc_hpc_combined_controls_cell_type_set.,/resources/baselineLD_v2.2_bedfiles/CTCF_Hoffman.extend.500.,/resources/baselineLD_v2.2_bedfiles/Conserved_LindbladToh.,/resources/baselineLD_v2.2_bedfiles/Coding_UCSC.,/resources/baselineLD_v2.2_bedfiles/Conserved_LindbladToh.extend.500.,/resources/baselineLD_v2.2_bedfiles/CTCF_Hoffman.,/resources/baselineLD_v2.2_bedfiles/DGF_ENCODE.,/resources/baselineLD_v2.2_bedfiles/DHS_Trynka.,/resources/baselineLD_v2.2_bedfiles/DGF_ENCODE.extend.500.,/resources/baselineLD_v2.2_bedfiles/Enhancer_Hoffman.extend.500.,/resources/baselineLD_v2.2_bedfiles/Enhancer_Hoffman.,/resources/baselineLD_v2.2_bedfiles/DHS_peaks_Trynka.,/resources/baselineLD_v2.2_bedfiles/Enhancer_Andersson.,/resources/baselineLD_v2.2_bedfiles/Enhancer_Andersson.extend.500.,/resources/baselineLD_v2.2_bedfiles/DHS_Trynka.extend.500.,/resources/baselineLD_v2.2_bedfiles/H3K27ac_Hnisz.extend.500.,/resources/baselineLD_v2.2_bedfiles/H3K27ac_PGC2.extend.500.,/resources/baselineLD_v2.2_bedfiles/H3K27ac_Hnisz.,/resources/baselineLD_v2.2_bedfiles/H3K27ac_PGC2.,/resources/baselineLD_v2.2_bedfiles/FetalDHS_Trynka.extend.500.,/resources/baselineLD_v2.2_bedfiles/FetalDHS_Trynka.,/resources/baselineLD_v2.2_bedfiles/H3K4me1_peaks_Trynka.,/resources/baselineLD_v2.2_bedfiles/H3K4me1_Trynka.extend.500.,/resources/baselineLD_v2.2_bedfiles/H3K4me3_peaks_Trynka.,/resources/baselineLD_v2.2_bedfiles/H3K9ac_Trynka.,/resources/baselineLD_v2.2_bedfiles/H3K4me1_Trynka.,/resources/baselineLD_v2.2_bedfiles/H3K9ac_peaks_Trynka.,/resources/baselineLD_v2.2_bedfiles/H3K9ac_Trynka.extend.500.,/resources/baselineLD_v2.2_bedfiles/H3K4me3_Trynka.,/resources/baselineLD_v2.2_bedfiles/Promoter_UCSC.extend.500.,/resources/baselineLD_v2.2_bedfiles/H3K4me3_Trynka.extend.500.,/resources/baselineLD_v2.2_bedfiles/PromoterFlanking_Hoffman.extend.500.,/resources/baselineLD_v2.2_bedfiles/Promoter_UCSC.,/resources/baselineLD_v2.2_bedfiles/PromoterFlanking_Hoffman.,/resources/baselineLD_v2.2_bedfiles/SuperEnhancer_Hnisz.extend.500.,/resources/baselineLD_v2.2_bedfiles/Intron_UCSC.extend.500.,/resources/baselineLD_v2.2_bedfiles/SuperEnhancer_Hnisz.,/resources/baselineLD_v2.2_bedfiles/Intron_UCSC.,/resources/baselineLD_v2.2_bedfiles/Repressed_Hoffman.extend.500.,/resources/baselineLD_v2.2_bedfiles/Repressed_Hoffman.,/resources/baselineLD_v2.2_bedfiles/Transcribed_Hoffman.,/resources/baselineLD_v2.2_bedfiles/TFBS_ENCODE.extend.500.,/resources/baselineLD_v2.2_bedfiles/TFBS_ENCODE.,/resources/baselineLD_v2.2_bedfiles/UTR_5_UCSC.extend.500.,/resources/baselineLD_v2.2_bedfiles/UTR_5_UCSC.,/resources/baselineLD_v2.2_bedfiles/WeakEnhancer_Hoffman.,/resources/baselineLD_v2.2_bedfiles/UTR_3_UCSC.extend.500.,/resources/baselineLD_v2.2_bedfiles/UTR_3_UCSC.,/resources/baselineLD_v2.2_bedfiles/TSS_Hoffman.extend.500.,/resources/baselineLD_v2.2_bedfiles/TSS_Hoffman.,/resources/baselineLD_v2.2_bedfiles/Transcribed_Hoffman.extend.500.,/resources/baselineLD_v2.2_bedfiles/WeakEnhancer_Hoffman.extend.500.,/resources/baselineLD_v2.2_bedfiles/Conserved_Vertebrate_phastCons46way.extend.500.,/resources/baselineLD_v2.2_bedfiles/Conserved_Mammal_phastCons46way.extend.500.,/resources/baselineLD_v2.2_bedfiles/Conserved_Primate_phastCons46way.extend.500.,/resources/baselineLD_v2.2_bedfiles/Conserved_Mammal_phastCons46way.,/resources/baselineLD_v2.2_bedfiles/Conserved_Primate_phastCons46way.,/resources/baselineLD_v2.2_bedfiles/Conserved_Vertebrate_phastCons46way.,/resources/baselineLD_v2.2_bedfiles/BivFlnk.extend.500.,/resources/baselineLD_v2.2_bedfiles/BivFlnk.,/resources/baselineLD_v2.2_bedfiles/Vahedi_Tcell_TE.,/resources/baselineLD_v2.2_bedfiles/Vahedi_Tcell_TE_500bp.,/resources/baselineLD_v2.2_bedfiles/Vahedi_Tcell_SE.,/resources/baselineLD_v2.2_bedfiles/Vahedi_Tcell_SE_500bp.,/resources/baselineLD_v2.2_bedfiles/ASMC.,/resources/baselineLD_v2.2_bedfiles/Human_Promoter_Villar_ExAC.,/resources/baselineLD_v2.2_bedfiles/Human_Enhancer_Villar.,/resources/baselineLD_v2.2_bedfiles/Human_Promoter_Villar.,/resources/baselineLD_v2.2_bedfiles/Ancient_Sequence_Age_Human_Promoter.,/resources/baselineLD_v2.2_bedfiles/Ancient_Sequence_Age_Human_Enhancer.,/resources/baselineLD_v2.2_bedfiles/Human_Promoter_Villar.extend.500.,/resources/baselineLD_v2.2_bedfiles/Human_Promoter_Villar_ExAC.extend.500.,/resources/baselineLD_v2.2_bedfiles/Human_Enhancer_Villar.extend.500.,/resources/baselineLD_v2.2_bedfiles/Ancient_Sequence_Age_Human_Promoter.extend.500.,/resources/baselineLD_v2.2_bedfiles/Ancient_Sequence_Age_Human_Enhancer.extend.500.,/resources/baselineLD_v2.2_bedfiles/Human_Enhancer_Villar_Species_Enhancer_Count.,/resources/baselineLD_v2.2_bedfiles/Backgrd_Selection_Stat.,/resources/baselineLD_v2.2_bedfiles/GTEx_FE_META_TISSUE_GE_MaxCPP.,/resources/baselineLD_v2.2_bedfiles/BLUEPRINT_FE_META_TISSUE_H3K4me1_MaxCPP.,/resources/baselineLD_v2.2_bedfiles/BLUEPRINT_FE_META_TISSUE_H3K27ac_MaxCPP.,/resources/baselineLD_v2.2_bedfiles/BLUEPRINT_FE_META_TISSUE_DNAMETH_MaxCPP.,/resources/baselineLD_v2.2_bedfiles/alleleage.,/resources/baselineLD_v2.2_bedfiles/Coding_UCSC.extend.500. --out kunkle_enrichments_reproducible.heritability --thin-annot  --frqfile-chr /resources/1000G_Phase3_frq/1000G.EUR.QC. --w-ld-chr /resources/weights_hm3_no_hla/weights. --print-coefficients


conda deactivate



